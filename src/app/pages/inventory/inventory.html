<div class="inventory-container">
  <div class="inventory-header">
    <h2>Inventory Management</h2>
    <div class="search-bar">
      <input 
        type="text" 
        [(ngModel)]="searchQuery" 
        placeholder="Search products..."
        (keyup.enter)="searchInventory()"
      >
      <button (click)="searchInventory()">Search</button>
    </div>
  </div>

  <nav class="inventory-tabs">
    <button 
      [class.active]="selectedTab === 'overview'" 
      (click)="selectedTab = 'overview'">
      Overview
    </button>
    <button 
      [class.active]="selectedTab === 'items'" 
      (click)="selectedTab = 'items'">
      Inventory Items
    </button>
    <button 
      [class.active]="selectedTab === 'movements'" 
      (click)="selectedTab = 'movements'">
      Stock Movements
    </button>
    <button 
      [class.active]="selectedTab === 'alerts'" 
      (click)="selectedTab = 'alerts'">
      Alerts
    </button>
    <button 
      [class.active]="selectedTab === 'orders'" 
      (click)="selectedTab = 'orders'">
      Purchase Orders
    </button>
  </nav>

  <!-- Overview Tab -->
  <div *ngIf="selectedTab === 'overview'" class="tab-content">
    <div class="overview-cards">
      <div class="card">
        <h3>Total Inventory Value</h3>
        <p class="value">{{ getTotalInventoryValue() | currency }}</p>
      </div>
      <div class="card">
        <h3>Total Items</h3>
        <p class="value">{{ inventoryItems.length }}</p>
      </div>
      <div class="card alert-card">
        <h3>Low Stock Items</h3>
        <p class="value">{{ getLowStockItems().length }}</p>
      </div>
      <div class="card alert-card critical">
        <h3>Out of Stock</h3>
        <p class="value">{{ getOutOfStockItems().length }}</p>
      </div>
    </div>

    <div class="alerts-section">
      <h3>Recent Alerts</h3>
      <div *ngFor="let alert of alerts.slice(0, 5)" class="alert-item">
        <span class="alert-type {{alert.type}}">{{ alert.type }}</span>
        <span class="alert-message">{{ alert.message }}</span>
        <span class="alert-date">{{ alert.createdAt | date:'short' }}</span>
      </div>
    </div>
  </div>

  <!-- Inventory Items Tab -->
  <div *ngIf="selectedTab === 'items'" class="tab-content">
    <table class="inventory-table">
      <thead>
        <tr>
          <th>Product</th>
          <th>SKU</th>
          <th>Current Stock</th>
          <th>Min Stock</th>
          <th>Max Stock</th>
          <th>Reorder Point</th>
          <th>Unit Cost</th>
          <th>Total Value</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of inventoryItems" 
            [class.low-stock]="item.currentStock <= item.reorderPoint"
            [class.out-of-stock]="item.currentStock === 0">
          <td>{{ item.product.name || 'Unknown' }}</td>
          <td>{{ item.product.sku || 'N/A' }}</td>
          <td>{{ item.currentStock }}</td>
          <td>{{ item.minimumStock }}</td>
          <td>{{ item.maximumStock }}</td>
          <td>{{ item.reorderPoint }}</td>
          <td>{{ item.averageCost | currency }}</td>
          <td>{{ item.currentStock * item.averageCost | currency }}</td>
          <td>
            <span class="status {{item.status}}">{{ item.status }}</span>
          </td>
          <td>
            <button (click)="updateStock(item, 1, 'adjustment', 'Manual adjustment')">+1</button>
            <button (click)="updateStock(item, -1, 'adjustment', 'Manual adjustment')">-1</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Stock Movements Tab -->
  <div *ngIf="selectedTab === 'movements'" class="tab-content">
    <table class="movements-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Product</th>
          <th>Type</th>
          <th>Quantity</th>
          <th>Previous</th>
          <th>New</th>
          <th>Reason</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let movement of stockMovements.slice().reverse()">
          <td>{{ movement.timestamp | date:'short' }}</td>
          <td>{{ getProductName(movement.inventoryItemId) }}</td>
          <td class="movement-type {{movement.type}}">{{ movement.type }}</td>
          <td [class.positive]="movement.quantity > 0"
              [class.negative]="movement.quantity < 0">
            {{ movement.quantity > 0 ? '+' : '' }}{{ movement.quantity }}
          </td>
          <td>{{ movement.previousStock }}</td>
          <td>{{ movement.newStock }}</td>
          <td>{{ movement.reason || 'N/A' }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Alerts Tab -->
  <div *ngIf="selectedTab === 'alerts'" class="tab-content">
    <div *ngFor="let alert of alerts" class="alert-card {{alert.severity}}">
      <div class="alert-header">
        <h4>{{ alert.title }}</h4>
        <span class="severity {{alert.severity}}">{{ alert.severity }}</span>
      </div>
      <p>{{ alert.message }}</p>
      <div class="alert-details">
        <span>Current: {{ alert.currentValue }}</span>
        <span>Threshold: {{ alert.thresholdValue }}</span>
        <span>{{ alert.createdAt | date:'medium' }}</span>
      </div>
    </div>
  </div>

  <!-- Purchase Orders Tab -->
  <div *ngIf="selectedTab === 'orders'" class="tab-content">
    <div class="orders-placeholder">
      <h3>Purchase Orders Management</h3>
      <p>This feature will be implemented in the next phase.</p>
      <p>It will include:</p>
      <ul>
        <li>Create and manage purchase orders</li>
        <li>Track order status and delivery</li>
        <li>Receive stock against orders</li>
        <li>Supplier management</li>
      </ul>
    </div>
  </div>
</div>